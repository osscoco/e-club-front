<section class="mt-16 w-full px-4 py-12 bg-black">
    <!-- Titre Section -->
    <div class="mb-8">
        <h2 class="text-white text-2xl sm:text-3xl font-bold">MOT DE PASSE OUBLIÉ</h2>
    </div>

    <div class="divider">Vérifier son adresse email (1/3)</div>

    <!-- Corps Section -->
    <div class="mx-auto w-full max-w-md">
        <div class="card bg-base-100 shadow-xl">
            <div class="card-body">
                <!-- Formulaire GetUserByMail -->
                <form [formGroup]="formGetOneUserByMail" (ngSubmit)="submitFormGetOneUserByMail()" class="space-y-4">
                    <!-- Email -->
                    <label class="form-control w-full">
                        <div class="label">
                            <span class="label-text">Email</span><span class="text-red-500">*</span>
                        </div>
                        <input type="email" formControlName="email" class="input input-bordered w-full mb-5" placeholder="votre.email@exemple.com" autocomplete="email" [readonly]="isFormGetOneUserByMailSent" />
                        <div class="label h-5">
                            <span class="label-text-alt text-error" *ngIf="email.touched && email.invalid">
                                <ng-container *ngIf="email.errors?.['required']">L'email est requis.</ng-container>
                                <ng-container *ngIf="email.errors?.['email']">Format d'email invalide.</ng-container>
                            </span>
                        </div>
                        <div>&nbsp;</div>
                    </label>
                    <!-- Erreur globale -->
                    <p *ngIf="error" class="text-error text-sm">{{ error }}</p>
                    <!-- Validation Formulaire -->
                    <button class="btn bg-red-500 text-white w-full" [disabled]="formGetOneUserByMail.invalid || isFormGetOneUserByMailSent">
                        <span>Rechercher</span>
                    </button>
                </form>
            </div>
        </div>
    </div>

    <div class="divider">Saisir son code temporaire (2/3)</div>

    <!-- Corps Section -->
    <div class="mx-auto w-full max-w-md">
        <div class="card bg-base-100 shadow-xl">
            <div class="card-body">
                <!-- Formulaire GetTemporaryCode -->
                <form [formGroup]="formGetTemporaryCode" (ngSubmit)="submitFormGetTemporaryCode()" class="space-y-4">
                    <!-- Temporary Code -->
                    <label class="form-control w-full">
                        <div class="label">
                            <span class="label-text">Code Temporaire</span><span class="text-red-500">*</span>
                        </div>
                        <input type="text" formControlName="temporaryCode" class="input input-bordered w-full mb-5" placeholder="XXX" autocomplete="temporaryCode" [readonly]="!isFormGetOneUserByMailSent" />
                        <div class="label h-5">
                            <span class="label-text-alt text-error" *ngIf="temporaryCode.touched && temporaryCode.invalid">
                                <ng-container *ngIf="temporaryCode.errors?.['required']">Le code temporaire est requis.</ng-container>
                            </span>
                        </div>
                        <div>&nbsp;</div>
                    </label>
                    <!-- Erreur globale -->
                    <p *ngIf="error" class="text-error text-sm">{{ error }}</p>
                    <!-- Validation Formulaire -->
                    <button class="btn bg-red-500 text-white w-full" [disabled]="formGetTemporaryCode.invalid || isFormGetTemporaryCodeSent">
                        <span>Vérifier</span>
                    </button>
                </form>
            </div>
        </div>
    </div>

    <div class="divider">Saisir son nouveau mot de passe (3/3)</div>

    <!-- Corps Section -->
    <div class="mx-auto w-full max-w-md">
        <div class="card bg-base-100 shadow-xl">
            <div class="card-body">
                <!-- Formulaire SetNewPassword -->
                <form [formGroup]="formSetNewPassword" (ngSubmit)="submitFormSetNewPassword()" class="space-y-4">
                    <!-- Ligne: Mot de passe | Confirmation -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <!-- Mot de passe -->
                        <label class="form-control w-full">
                            <div class="label">
                                <span class="label-text">Mot de passe</span><span class="text-red-500">*</span>
                            </div>
                            <div class="join" style="width: -webkit-fill-available;">
                                <input [type]="showPwd ? 'text' : 'password'" formControlName="password" class="input input-bordered w-full" placeholder="••••••••" autocomplete="new-password" [readonly]="!isFormGetTemporaryCodeSent" />
                                <button
                                    type="button"
                                    class="btn btn-ghost join-item"
                                    (click)="showPwd = !showPwd"
                                    [attr.aria-pressed]="showPwd"
                                    [attr.aria-label]="showPwd ? 'Masquer le mot de passe' : 'Afficher le mot de passe'"
                                    >
                                    <!-- Icône œil (afficher) -->
                                    <svg *ngIf="!showPwd" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none"
                                        viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5" aria-hidden="true">
                                        <path stroke-linecap="round" stroke-linejoin="round"
                                            d="M2.036 12.322a1.012 1.012 0 010-.644C3.423 7.51 7.36 5 12 5c4.64 0 8.577 2.51 9.964 6.678.07.214.07.43 0 .644C20.577 16.49 16.64 19 12 19c-4.64 0-8.577-2.51-9.964-6.678z" />
                                        <path stroke-linecap="round" stroke-linejoin="round"
                                            d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                                    </svg>

                                    <!-- Icône œil barré (masquer) -->
                                    <svg *ngIf="showPwd" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none"
                                        viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5" aria-hidden="true">
                                        <path stroke-linecap="round" stroke-linejoin="round"
                                            d="M3 3l18 18M10.584 10.584A3 3 0 0013.5 13.5M6.532 6.532C4.58 7.68 3.17 9.4 2.536 11.322a1.012 1.012 0 000 .356C3.923 15.49 7.86 18 12.5 18c1.33 0 2.6-.2 3.78-.572M9.75 5.27A10.4 10.4 0 0112.5 5c4.64 0 8.577 2.51 9.964 6.678.07.214.07.43 0 .644-.33.96-.86 1.84-1.55 2.61" />
                                    </svg>
                                </button>
                            </div>
                            
                            <div class="label h-5">
                                <span class="label-text-alt text-error" *ngIf="password.touched && password.invalid">
                                    <ng-container *ngIf="password.errors?.['required']">Requis</ng-container>
                                    <ng-container *ngIf="password.errors?.['maxlength']">
                                        Maximum {{ password.errors?.['maxlength']?.requiredLength }} caractères.
                                    </ng-container>
                                </span>
                            </div>
                        </label>
                        <!-- Confirmation mot de passe -->
                        <label class="form-control w-full">
                            <div class="label">
                                <span class="label-text">Confirmation</span><span class="text-red-500">*</span>
                            </div>
                            <div class="join" style="width: -webkit-fill-available;">
                                <input [type]="showPwdConfirm ? 'text' : 'password'" formControlName="confirmPassword" class="input input-bordered w-full" placeholder="••••••••" autocomplete="new-password" [readonly]="!isFormGetTemporaryCodeSent"/>
                                <button
                                    type="button"
                                    class="btn btn-ghost join-item"
                                    (click)="showPwdConfirm = !showPwdConfirm"
                                    [attr.aria-pressed]="showPwdConfirm"
                                    [attr.aria-label]="showPwdConfirm ? 'Masquer le mot de passe' : 'Afficher le mot de passe'"
                                    >
                                    <!-- Icône œil (afficher) -->
                                    <svg *ngIf="!showPwdConfirm" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none"
                                        viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5" aria-hidden="true">
                                        <path stroke-linecap="round" stroke-linejoin="round"
                                            d="M2.036 12.322a1.012 1.012 0 010-.644C3.423 7.51 7.36 5 12 5c4.64 0 8.577 2.51 9.964 6.678.07.214.07.43 0 .644C20.577 16.49 16.64 19 12 19c-4.64 0-8.577-2.51-9.964-6.678z" />
                                        <path stroke-linecap="round" stroke-linejoin="round"
                                            d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                                    </svg>

                                    <!-- Icône œil barré (masquer) -->
                                    <svg *ngIf="showPwdConfirm" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none"
                                        viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5" aria-hidden="true">
                                        <path stroke-linecap="round" stroke-linejoin="round"
                                            d="M3 3l18 18M10.584 10.584A3 3 0 0013.5 13.5M6.532 6.532C4.58 7.68 3.17 9.4 2.536 11.322a1.012 1.012 0 000 .356C3.923 15.49 7.86 18 12.5 18c1.33 0 2.6-.2 3.78-.572M9.75 5.27A10.4 10.4 0 0112.5 5c4.64 0 8.577 2.51 9.964 6.678.07.214.07.43 0 .644-.33.96-.86 1.84-1.55 2.61" />
                                    </svg>
                                </button>
                            </div>
                            <div class="label h-5">
                                <span class="label-text-alt text-error" *ngIf="formSetNewPassword.hasError('passwordMismatch') && confirmPassword.touched">
                                Incorrespondance
                                </span>
                            </div>
                        </label>
                    </div>
                    <!-- Erreur globale -->
                    <p *ngIf="error" class="text-error text-sm">{{ error }}</p>
                    <!-- Validation Formulaire -->
                    <button class="btn bg-red-500 text-white w-full" [disabled]="formSetNewPassword.invalid || isFormSetNewPasswordSent">
                        <span>Modifier</span>
                    </button>
                </form>
            </div>
        </div>
        <!-- Lien Inscription -->
        <p class="text-center text-sm text-base-content/70 mt-4">
            Pas encore de compte ?
            <a (click)="register()" class="text-red-500 hover:text-white font-medium no-underline cursor-pointer">
                S'inscrire
            </a>
        </p>
        <!-- Lien Connexion -->
        <p class="text-center text-sm text-base-content/70 mt-4">
            Déjà un compte ?
            <a (click)="login()" class="text-red-500 hover:text-white font-medium no-underline cursor-pointer">
                Se connecter
            </a>
        </p>
    </div>

</section>